---
title: 自定义域名
description: 添加和管理您的自定义域名。
---

## 什么是自定义域名？

自定义域名允许您使用自己的域名来代替系统默认的域名。例如，您可以使用 `your-domain.com` 而不是 `apil.top`。这样不仅能够打造您的专属品牌形象，还能给您带来更多的隐私和控制权。

## 为什么使用自定义域名？

- **品牌一致性**：使用您自己的域名可以保持品牌一致性
- **增强专业形象**：自定义域名让您的链接和DNS记录看起来更专业
- **更好的可控性**：完全控制您的域名配置
- **隐私保护**：使用自己的域名可以增强隐私保护
- **电子邮箱服务**：通过自定义域名发送和接收电子邮件

## 如何添加自定义域名

通过Cloudflare集成可以轻松添加自定义域名：

### Cloudflare集成方式

如果您的域名已经托管在Cloudflare上，这是最简单的设置方式：

1. 登录您的Cloudflare账户
2. 在【apil.top】控制台中选择 **自定义域名** > **添加自定义域名**
3. 输入您的域名（例如 `example.com`）
4. 提交后，系统会生成一个验证密钥
5. 在Cloudflare的DNS设置中，添加一条TXT记录：
   - 名称：`_kedaya.example.com`（请替换成您的域名）
   - 内容：系统生成的验证密钥
6. 回到【apil.top】，点击"验证"按钮
7. 验证成功后，您的自定义域名即可使用

## 使用您的自定义域名

一旦自定义域名设置并验证完成，您可以在以下场景中使用它：

### 用于短链接

创建短链接时，您可以从下拉列表中选择您的自定义域名。例如，使用 `example.com/abc123` 而不是 `apil.top/abc123`。

### 设置DNS以启用短链接功能

要让您的用户能够将他们的自定义域名用于您的短链接服务，他们需要按照以下步骤配置其DNS记录：

#### 第1步：用户添加自定义域名到您的平台

1. 用户登录您的平台
2. 进入"自定义域名"设置页面
3. 输入他们想要使用的域名（例如 `example.com`）
4. 系统会生成一个验证密钥
5. 用户需要在其DNS服务商处添加此验证记录

#### 第2步：用户验证域名所有权

用户需要在他们的DNS服务商处添加以下TXT记录：

| 记录类型 | 主机记录 | 记录值 | TTL |
| -------- | -------- | ----------- | --- |
| TXT | _kedaya | 系统生成的验证密钥 | 自动 |

#### 第3步：用户配置域名指向您的服务

验证完成后，用户需要将其域名指向您的服务。他们应该添加以下DNS记录：

| 记录类型 | 主机记录 | 指向值/目标 | TTL |
| -------- | -------- | ----------- | --- |
| A | @ | 76.76.21.21 | 自动 |

或者，如果用户的DNS服务商支持根域名CNAME（如Cloudflare的CNAME扁平化），他们可以使用：

| 记录类型 | 主机记录 | 指向值/目标 | TTL |
| -------- | -------- | ----------- | --- |
| CNAME | @ | cname-china.vercel-dns.com | 自动 |

#### 子域名配置

对于子域名（如 `www.example.com`），用户应添加：

| 记录类型 | 主机记录 | 指向值/目标 | TTL |
| -------- | -------- | ----------- | --- |
| CNAME | www | cname-china.vercel-dns.com | 自动 |

<Callout type="info">
  DNS记录生效可能需要一些时间（从几分钟到48小时不等）。配置完成后，用户可以通过在浏览器中访问他们的域名来测试是否已正确设置。
</Callout>

### 用于DNS记录

一旦用户的自定义域名配置完成，他们可以在您的平台上创建DNS记录，格式为 `name.example.com`。

### 用于电子邮件服务

<Callout type="info">
  电子邮件功能仅适用于已验证的自定义域名，并且需要额外的配置步骤。
</Callout>

当用户配置自定义域名后，他们可以：

- 使用他们的域名发送电子邮件 (例如：`noreply@their-domain.com`)
- 接收发送到他们域名的电子邮件
- 建立完整的企业邮箱解决方案

## 配置自定义域名邮箱服务

要让用户启用自定义域名的电子邮件功能，他们需要按照以下步骤操作：

### 步骤 1：确认域名已验证

用户需要确保他们的自定义域名已通过验证。如果尚未验证，请按照上述方法进行验证。

### 步骤 2：部署Cloudflare Worker邮件转发服务

用户需要：

1. 确保已安装Node.js和pnpm
2. 克隆邮件转发Worker项目并部署到Cloudflare:

   ```bash
   git clone https://github.com/kiss-kedaya/cf-email-forwarding-worker.git
   cd cf-email-forwarding-worker
   pnpm install

   wrangler login
   wrangler deploy
   ```

3. 按照部署完成后的提示配置Worker
4. 在您的平台控制台中启用邮箱服务

### 步骤 3：配置DNS记录

用户需要添加以下DNS记录到他们的域名：

#### MX记录

MX记录指定负责接收发送到域名的电子邮件的服务器。

| 主机记录 | 记录类型 | 优先级 | 记录值                  |
| -------- | -------- | ------ | ----------------------- |
| @        | MX       | 10     | mail.yourmailserver.com |

#### SPF记录 (TXT记录)

SPF记录帮助防止邮件欺诈，指定哪些服务器可以发送来自域名的邮件。

| 主机记录 | 记录类型 | 记录值                                       |
| -------- | -------- | -------------------------------------------- |
| @        | TXT      | v=spf1 include:\_spf.yourmailserver.com ~all |

#### DKIM记录 (TXT记录)

DKIM为电子邮件提供数字签名，验证邮件的真实性。

| 主机记录            | 记录类型 | 记录值                                 |
| ------------------- | -------- | -------------------------------------- |
| default.\_domainkey | TXT      | v=DKIM1; k=rsa; p=YOUR_DKIM_PUBLIC_KEY |

#### DMARC记录 (TXT记录)

DMARC定义了收件人如何处理未通过SPF或DKIM验证的邮件。

| 主机记录 | 记录类型 | 记录值                                            |
| -------- | -------- | ------------------------------------------------- |
| \_dmarc  | TXT      | v=DMARC1; p=none; rua=mailto:dmarc@theirdomain.com |

### 步骤 4：验证配置

用户需要：
1. 在邮箱服务配置面板中点击"验证DNS记录"按钮，确认所有必要的DNS记录都已正确配置
2. 检查"状态"选项卡，查看全面的服务状态报告
3. 发送测试邮件，验证邮件转发功能是否正常工作

## 常见问题

### 用户可以添加多少个自定义域名？

不同的用户计划有不同的限制：

- 免费用户：不支持自定义域名
- 高级用户：可添加1个自定义域名
- 企业用户：可添加5个自定义域名

### 用户如何验证域名所有权？

用户需要在其DNS配置中添加特定的TXT记录来验证域名所有权。验证通常在几分钟到几小时内完成。

### 用户可以删除自定义域名吗？

是的，用户可以随时删除自定义域名。但请提醒用户，删除域名会导致使用该域名的所有短链接、DNS记录和邮箱服务失效。

### 为什么用户的邮箱服务验证失败？

邮箱服务验证失败的常见原因包括：

1. DNS记录配置不正确（检查MX、SPF、DKIM和DMARC记录）
2. DNS记录尚未完全传播（可能需要等待几分钟到48小时）
3. Cloudflare Worker配置不正确
4. Worker部署失败或未激活

### 如何帮助用户排查域名验证问题？

如果用户的域名验证失败，建议他们检查：

1. TXT记录是否正确添加
2. DNS记录是否已经生效（DNS传播可能需要几分钟到48小时）
3. 域名格式是否正确（不要包含http://或https://前缀）

如果用户遇到其他问题，请鼓励他们联系您的支持团队寻求帮助。
